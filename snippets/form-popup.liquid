{%- comment -%}
  Usage:
  {% render 'form-popup', form_popup_name: string %}
{%- endcomment -%}

{%- liquid
  assign form_id = section.id | append: '-contact'
  assign color_scheme = section.settings.color_scheme
  assign bg_color = false

  if color_scheme == 'default'
    assign bg_color = settings.bg_color
  elsif color_scheme == '1'
    assign bg_color = settings.color_scheme_1_bg_grad | default: settings.color_scheme_1_bg
  elsif color_scheme == '2'
    assign bg_color = settings.color_scheme_2_bg_grad | default: settings.color_scheme_2_bg
  elsif color_scheme == '3'
    assign bg_color = settings.color_scheme_3_bg_grad | default: settings.color_scheme_3_bg
  endif

  if bg_color == 'rgba(0,0,0,0)' or bg_color == settings.bg_color
    assign bg_color = false
  endif
-%}

{%  style  %}
  /* Popup overlay */
  .{{ form_popup_name }}-form-popup-overlay {
    display: none;
    /* Hidden by default */
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 100;
  }

  /* Popup content */
  .{{ form_popup_name }}-form-popup-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: white;
    border-radius: 5px;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    width: 100%;
    max-width: 820px;
    height: 100%;
    max-height: 650px;
    border-radius: 15px;
    transition: transform 0.3s ease;
    display: flex; /* Add flexbox */
    justify-content: center; /* Center horizontally */
    align-items: center; /* Center vertically */
  }
  .{{ form_popup_name }}-form-popup-close {
    position: absolute;
    top: 10px;
    right: 15px;
    font-size: 30px;
    cursor: pointer;
  }

  .{{ form_popup_name }}-form-popup-info {
    padding: 80px;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    margin: 0 20px;
  }
  .{{ form_popup_name }}-form-popup-info h2 {
    font-family: Poppins;
    font-size: 32px;
    font-weight: 600;
    line-height: 42px;
    text-align: center;
    color: #000;
    margin-bottom: 20px;
  }
  .{{ form_popup_name }}-form-popup-info p {
    /* font-family: Poppins; */
    font-size: 18px;
    font-weight: 300;
    line-height: 27px;
    text-align: center;
    color: #000000;
    margin-bottom: 0;
  }
  .{{ form_popup_name }}-form-popup-info a.btn {
    display: block;
    background: #1B413E;
    width: 100%;
    padding: 10px 20px;
    font-size: 18px;
    font-weight: 600;
    line-height: 27px;
    border-radius: 6px;
    margin-top: 40px;
  }
  @media only screen and (max-width: 768px) {
    .{{ form_popup_name }}-form-popup-content {
      max-height: 700px;
      max-width: 92%;
    }
    .{{ form_popup_name }}-form-popup-info {
      margin: 0 0 0 10px;
      padding: 20px 0 20px 20px;
    }
    .{{ form_popup_name }}-form-popup-info h2 {
      font-size: 28px;
      line-height: 36px;
    }
  }
  @media only screen and (max-width: 600px) {
    .{{ form_popup_name }}-form-popup-info h2 {
      font-size: 24px;
      line-height: 32px;
    }
    .{{ form_popup_name }}-form-popup-info p {
      font-size: 16px;
      line-height: 24px;
      font-weight: 400;
    }
    .{{ form_popup_name }}-form-popup-info {
      padding: 30px;
      margin: 0;
      height: 100%;
      border-radius: 10px;
    }
    .{{ form_popup_name }}-form-popup-content {
      border-radius: 10px;
    }
    .{{ form_popup_name }}-form-popup-content-row {
      grid-template-columns: 100%;
      align-items: center;
    }

    .{{ form_popup_name }}-form-popup-media {
      display: none;
    }
    .{{ form_popup_name }}-form-popup-info a.btn {
      padding: 7px 10px;
      font-size: 16px;
      line-height: 24px;
      margin-top: 30px;
    }
  }

  #{{ form_popup_name }}-contact-form label::after {
    content: "*";
    color: red;
  }

  #{{ form_popup_name }}-contact-form label {
    font-size: 14px;
    color: #000;
  }

  #{{ form_popup_name }}-contact-form input {
    border-radius:0.5rem;
  }

  #{{ form_popup_name }}-contact-form button {
    border-radius:0.5rem;
    font-size: 16px;
    background: #000;
  }

  #{{ form_popup_name }}-contact-form button:hover {
    color: #000;
    background: white;
  }

  .lastname-label {
    margin: 0 0 calc(2 * var(--space-unit));
    font-size: 0.88em;
    font-weight: 700;
    text-align: start;
  }

  .error {
    font-weight: 600 !important;
    font-size: small !important;
    text-align: left !important;
    color: red !important;
    margin-top: 5px;
    display: none;
  }

  input.error-field {
    border-color: red;
  }

  input.error-field:focus {
    border-color: red;
  }

  #{{ form_popup_name }}-contact-form input::placeholder {
    font-size: 14px;
  }
{%  endstyle  %}

<div
  id="{{ form_popup_name }}-contact-form"
  class="{{ form_popup_name }}-form-popup-overlay"
  style="display:none"
>
  <div class="{{ form_popup_name }}-form-popup-content">
    <span id="{{ form_popup_name }}-contact-form-close" class="close {{ form_popup_name }}-form-popup-close ">&times;</span>
    <div class="{{ form_popup_name }}-form-popup-info">
      <div class="{% if bg_color != false %} section--padded{% if section.settings.full_width %} section--full-width{% endif %}{% endif %}{% unless color_scheme == 'none' %} color-scheme color-scheme--{{ color_scheme }}{% endunless %}">
        {%- if section.settings.heading != blank -%}
          <div
            class="section__header reading-width rte"
            {% if settings.animations_enabled != 'disabled' %}
              data-cc-animate
            {% endif %}
          >
            <h2 class="h4 section__heading {{ section.settings.heading_align }}">
              {{ section.settings.heading | escape }}
            </h2>
          </div>
        {%- endif -%}

        <form
          id="{{ form_popup_name }}-form"
          class="form reading-width"
          action="{{ section.settings.send_link }}"
          method="POST"
        >
          <div
            class="form__grid grid grid-cols-2 gap-x-theme gap-y-6"
            {% if settings.animations_enabled != 'disabled' %}
              data-cc-animate
            {% endif %}
          >
            {%- for block in section.blocks -%}
              <div
                class="col-span-2{% if block.settings.half_width %} md:col-span-1{% endif %}{% if block.settings.required %} is-required{% endif %}"
                {{ block.shopify_attributes }}
              >
                {%- case block.type -%}
                  {%- when 'first_name' -%}
                    <label class="label" for="{{ form_id }}-first_name">Your Name</label>
                    <input
                      type="text"
                      class="input w-full"
                      id="{{ form_id }}-name"
                      name="First Name"
                      placeholder="First Name"
                      autocomplete="name"
                      {%- if block.settings.required %}
                        aria-required="true"
                        required
                      {%- endif %}
                    >

                  {%- when 'last_name' -%}
                    <label class="lastname-label hidden md:block invisible" for="{{ form_id }}-last_name"></label>
                    <input
                      type="text"
                      class="input w-full"
                      id="{{ form_id }}-name"
                      name="Last Name"
                      autocomplete="name"
                      placeholder="Last Name"
                      {%- if block.settings.required %}
                        aria-required="true"
                        required
                      {%- endif %}
                    >

                  {%- when 'email' -%}
                    <label class="label" for="{{ form_id }}-email">Email Address</label>
                    <input
                      type="email"
                      class="input w-full"
                      id="{{ form_id }}-email"
                      name="email"
                      autocomplete="email"
                      placeholder="i.e. johndoe@gmail.com"
                      {%- if block.settings.required %}
                        aria-required="true"
                        required
                      {%- endif %}
                    >

                  {%- when 'socmed_link' -%}
                    <label class="label" for="{{ form_id }}-socmed_link"> Social Media/Website Link </label>
                    <input
                      type="url"
                      class="input w-full"
                      id="{{ form_id }}-url"
                      name="Social Media/Website Link"
                      placeholder="i.e. www.instagram.com/salussaunas/"
                      autocomplete="url"
                      {%- if block.settings.required %}
                        aria-required="true"
                        required
                      {%- endif %}
                    >

                  {%- when 'body' -%}
                      <label class="label" for="{{ form_id }}-body">{{ 'contact.form.message' | t }}</label>
                      <textarea class="input w-full"
                                id="{{ form_id }}-body"
                                name="message"
                                placeholder="Message"
                                rows="8"
                                style="resize: none;"
                                {%- if block.settings.required %}
                                  aria-required="true"
                                  required
                                {%- endif %}></textarea>

                  {%- when 'preferred_code' -%}
                    <label class="label" for="{{ form_id }}-preferred_alphanumeric_code"> Preferred Alphanumeric Code </label>
                    <input
                      type="text"
                      class="input w-full"
                      id="{{ form_id }}-preferred_alphanumeric_code"
                      name="Preferred Alphanumeric Code"
                      placeholder="i.e. JANE200"
                      autocomplete="preferred-code"
                      {%- if block.settings.required %}
                        aria-required="true"
                        required
                      {%- endif %}
                    >
                   <p class="error" id="error-message">Input must include both letters and numbers</p>
                {%- endcase -%}
              </div>
            {%- endfor -%}
          </div>
          <div
            class="mt-6"
            {% if settings.animations_enabled != 'disabled' %}
              data-cc-animate
            {% endif %}
          >
            <button type="submit" class="{{ section.settings.button_style }} w-full">Send for review</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>